"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([["2798"],{62294:function(e,n,i){i.r(n),i.d(n,{default:()=>h,frontMatter:()=>a,metadata:()=>t,assets:()=>s,toc:()=>d,contentTitle:()=>l});var t=JSON.parse('{"id":"configuration/filament_sensors","title":"Filament Sensors","description":"RatOS supports multiple sensor types that are toolhead-aware. These sensors can be combined to work together. Configure them as described - no other changes are needed.","source":"@site/docs/configuration/filament_sensors.md","sourceDirName":"configuration","slug":"/configuration/filament_sensors","permalink":"/docs/configuration/filament_sensors","draft":false,"unlisted":false,"editUrl":"https://github.com/Rat-OS/RatOS/edit/v2.x/site/docs/configuration/filament_sensors.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Chamber Heater Control","permalink":"/docs/configuration/chamber_heater"},"next":{"title":"Filament Macros","permalink":"/docs/configuration/filaments"}}'),r=i("52676"),o=i("69532");let a={},l="Filament Sensors",s={},d=[{value:"Supported Sensors",id:"supported-sensors",level:2},{value:"RatOS Configuration",id:"ratos-configuration",level:2},{value:"Toolhead Filament Sensor",id:"toolhead-filament-sensor",level:2},{value:"Features",id:"features",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Bowden Filament Sensor",id:"bowden-filament-sensor",level:2},{value:"Features",id:"features-1",level:3},{value:"Configuration",id:"configuration-1",level:3},{value:"Motion Filament Sensor",id:"motion-filament-sensor",level:2},{value:"Features",id:"features-2",level:3},{value:"Configuration",id:"configuration-2",level:3},{value:"Action Button",id:"action-button",level:2},{value:"Features",id:"features-3",level:3},{value:"Configuration",id:"configuration-3",level:3},{value:"Orbiter Smart Filament Sensor example configuration",id:"orbiter-smart-filament-sensor-example-configuration",level:2},{value:"RatOS Configuration",id:"ratos-configuration-1",level:2},{value:"Sensor features",id:"sensor-features",level:3},{value:"Filament grabbing",id:"filament-grabbing",level:3},{value:"Purging",id:"purging",level:3},{value:"Feedrates",id:"feedrates",level:3},{value:"Retraction",id:"retraction",level:3},{value:"Parking Position",id:"parking-position",level:3},{value:"Advanced",id:"advanced",level:3}];function c(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"filament-sensors",children:"Filament Sensors"})}),"\n",(0,r.jsx)(n.p,{children:"RatOS supports multiple sensor types that are toolhead-aware. These sensors can be combined to work together. Configure them as described - no other changes are needed."}),"\n",(0,r.jsx)(n.p,{children:"When combining toolhead and bowden sensors, each sensor has a specific function. The toolhead sensor handles insert detection while the bowden sensor is responsible for runout detection. This has the benefit that you don't need to open a heated chamber and remove the bowden tube to remove old filament - it will be ejected and can be easily removed at the end of the bowden tube."}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"Sensors can be temporarily deactivated in the Mainsail user interface."})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:['If a sensor shows "detected" when no filament is loaded and "empty" when filament is loaded, invert the ',(0,r.jsx)(n.code,{children:"switch_pin"})," by adding or removing a ",(0,r.jsx)(n.code,{children:"!"})," in front of the pin name. The sensor state will be displayed in the Mainsail user interface."]})}),"\n",(0,r.jsx)(n.h2,{id:"supported-sensors",children:"Supported Sensors"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#toolhead-filament-sensor",children:"Toolhead Filament Sensor"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#bowden-filament-sensor",children:"Bowden Filament Sensor"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#motion-filament-sensor",children:"Motion Filament Sensor"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#action-button",children:"Action Button"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"ratos-configuration",children:"RatOS Configuration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#sensor-features",children:"Sensor features"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#filament-grabbing",children:"Filament grabbing"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#purging",children:"Purging"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#feedrates",children:"Feedrates"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#retraction",children:"Retraction"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#advanced",children:"Advanced"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"toolhead-filament-sensor",children:"Toolhead Filament Sensor"}),"\n",(0,r.jsx)(n.p,{children:"Toolhead filament sensors attach directly to the toolhead."}),"\n",(0,r.jsx)(n.h3,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Runout detection"}),"\n",(0,r.jsx)(n.li,{children:"Insert detection"}),"\n",(0,r.jsx)(n.li,{children:"Automatic filament loading on insert"}),"\n",(0,r.jsx)(n.li,{children:"Automatic filament unloading after runout"}),"\n",(0,r.jsx)(n.li,{children:"Automatic print resume after insert"}),"\n",(0,r.jsx)(n.li,{children:"Spool joining for IDEX printers"}),"\n",(0,r.jsx)(n.li,{children:"Filament grabbing on insert"}),"\n",(0,r.jsx)(n.li,{children:"Filament presence/runout check before starting a print"}),"\n",(0,r.jsx)(n.li,{children:"Frontend toolhead color status display"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[filament_switch_sensor toolhead_filament_sensor_t0]\npause_on_runout: False\nevent_delay: 0.1\nswitch_pin: ^!toolboard_t0:PB3\nrunout_gcode:\n    _ON_TOOLHEAD_FILAMENT_SENSOR_RUNOUT TOOLHEAD=0\ninsert_gcode:\n    _ON_TOOLHEAD_FILAMENT_SENSOR_INSERT TOOLHEAD=0\n"})}),"\n",(0,r.jsx)(n.h2,{id:"bowden-filament-sensor",children:"Bowden Filament Sensor"}),"\n",(0,r.jsx)(n.p,{children:"Bowden filament sensors attach somewhere along the bowden tube."}),"\n",(0,r.jsx)(n.h3,{id:"features-1",children:"Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Runout detection"}),"\n",(0,r.jsx)(n.li,{children:"Insert detection (no automatic action available, macro can be overridden)"}),"\n",(0,r.jsx)(n.li,{children:"Automatic filament unloading after runout"}),"\n",(0,r.jsx)(n.li,{children:"Spool joining for IDEX printers"}),"\n",(0,r.jsx)(n.li,{children:"Filament presence/runout check before starting a print"}),"\n",(0,r.jsx)(n.li,{children:"Frontend toolhead color status display"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configuration-1",children:"Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[filament_switch_sensor bowden_filament_sensor_t0]\npause_on_runout: False\nevent_delay: 0.1\nswitch_pin: ^!PC15\nrunout_gcode:\n    _ON_BOWDEN_FILAMENT_SENSOR_RUNOUT TOOLHEAD=0\ninsert_gcode:\n    _ON_BOWDEN_FILAMENT_SENSOR_INSERT TOOLHEAD=0\n"})}),"\n",(0,r.jsx)(n.h2,{id:"motion-filament-sensor",children:"Motion Filament Sensor"}),"\n",(0,r.jsx)(n.p,{children:"Motion sensors can detect filament clogs."}),"\n",(0,r.jsx)(n.h3,{id:"features-2",children:"Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Optional runout detection"}),"\n",(0,r.jsx)(n.li,{children:"Optional insert detection (no automatic action available, macro can be overridden)"}),"\n",(0,r.jsx)(n.li,{children:"Clog detection"}),"\n",(0,r.jsx)(n.li,{children:"Automatic filament unloading after runout"}),"\n",(0,r.jsx)(n.li,{children:"Spool joining for IDEX printers"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configuration-2",children:"Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[filament_motion_sensor bowden_filament_clog_t0]\nswitch_pin: ^PG15\ndetection_length: 8\nextruder: extruder   # extruder for T0, extruder1 for T1\npause_on_runout: False\nevent_delay: 3.0\npause_delay: 0.5\nrunout_gcode:\n  _ON_BOWDEN_FILAMENT_SENSOR_CLOG TOOLHEAD=0\ninsert_gcode:\n"})}),"\n",(0,r.jsx)(n.h2,{id:"action-button",children:"Action Button"}),"\n",(0,r.jsx)(n.p,{children:"Some filament sensors, like the Orbiter filament sensor, come with an action button."}),"\n",(0,r.jsx)(n.h3,{id:"features-3",children:"Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Filament unload"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configuration-3",children:"Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[gcode_button toolhead_filament_sensor_button_t0]\npin: ^!toolboard_t0:PB4\nrelease_gcode:\n  _ON_FILAMENT_SENSOR_BUTTON_PRESSED TOOLHEAD=0\npress_gcode:\n"})}),"\n",(0,r.jsx)(n.h2,{id:"orbiter-smart-filament-sensor-example-configuration",children:"Orbiter Smart Filament Sensor example configuration"}),"\n",(0,r.jsx)(n.p,{children:"The new Orbiter Smart Filament Sensor with filament tangle detection."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[filament_switch_sensor toolhead_filament_sensor_t0]\npause_on_runout: False\nevent_delay: 0.1\nswitch_pin: ^PA13\nrunout_gcode:\n    _ON_TOOLHEAD_FILAMENT_SENSOR_RUNOUT TOOLHEAD=0\ninsert_gcode:\n    _ON_TOOLHEAD_FILAMENT_SENSOR_INSERT TOOLHEAD=0\n\n[gcode_button toolhead_filament_sensor_button_t0]\npin: ^PA14\nrelease_gcode:\n    {% if (printer.print_stats.state == "printing") %}\n            _ON_TOOLHEAD_FILAMENT_SENSOR_CLOG TOOLHEAD=0\n    {% else %}\n            _ON_FILAMENT_SENSOR_BUTTON_PRESSED TOOLHEAD=0\n    {% endif %}\npress_gcode:\n'})}),"\n",(0,r.jsx)(n.h2,{id:"ratos-configuration-1",children:"RatOS Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"sensor-features",children:"Sensor features"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[gcode_macro T0]\nvariable_enable_insert_detection: True     # enables the insert detection\nvariable_enable_runout_detection: True     # enables the runout detection\nvariable_enable_clog_detection: True       # enables the clog detection\nvariable_unload_after_runout: True         # unload filament after runout has been detected\nvariable_resume_after_insert: True         # resumes the print after inserting new filament\n"})}),"\n",(0,r.jsx)(n.h3,{id:"filament-grabbing",children:"Filament grabbing"}),"\n",(0,r.jsx)(n.p,{children:"When inserting a filament into the toolhead filament sensor, the extruder gears will grab the filament, even if the hotend is still cold."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[gcode_macro T0]\nvariable_filament_grabbing_speed: 1     # filament grabbing speed in mm/s\nvariable_filament_grabbing_length: 5    # filament grabbing length in mm\n"})}),"\n",(0,r.jsx)(n.h3,{id:"purging",children:"Purging"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[gcode_macro T0]\nvariable_purge_after_load: 30      # purge x mm after the filament has been loaded to the nozzle tip\nvariable_purge_before_unload: 0    # purge x mm before the filament unloads\n"})}),"\n",(0,r.jsx)(n.h3,{id:"feedrates",children:"Feedrates"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[gcode_macro T0]\nvariable_filament_load_speed: 10   # filament nozzle loading speed\nvariable_extruder_load_speed: 60   # extruder/cooling zone loading speed\n"})}),"\n",(0,r.jsx)(n.h3,{id:"retraction",children:"Retraction"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[gcode_macro PAUSE]\nvariable_retract: 1.5   # retract on pause print\nvariable_extrude: 1.5   # extrude before resume print\n"})}),"\n",(0,r.jsx)(n.h3,{id:"parking-position",children:"Parking Position"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[gcode_macro RatOS]\nvariable_runout_park_in: "front"   # back|front|center = gantry parking position if a runout or clog has been detected\nvariable_runout_park_x: 50         # float = if configured the x position of the toolhead. if not configured it will park in the middle\n'})}),"\n",(0,r.jsx)(n.h3,{id:"advanced",children:"Advanced"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[gcode_macro T0]\nvariable_cooling_position_to_nozzle_distance: 40            # distance between the cooling position and the nozzle\nvariable_tooolhead_sensor_to_extruder_gear_distance: 15     # distance between the filament sensor trigger point\n                                                            # and where the filament hits the extruder gears\nvariable_extruder_gear_to_cooling_position_distance: 30     # distance between the extruder gears and the center of the heatsink cooling tube\nvariable_filament_loading_nozzle_offset: -10                # offset tuning value. positive or negative number.\n                                                            # different nozzles can lead to too much or not enough extrusion while loading the filament\n"})})]})}function h(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},69532:function(e,n,i){i.d(n,{Z:function(){return l},a:function(){return a}});var t=i(75271);let r={},o=t.createContext(r);function a(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);