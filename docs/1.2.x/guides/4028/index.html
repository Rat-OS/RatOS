<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-1.2.x docs-doc-page docs-doc-id-guides/4028" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>Connecting a 4028 fan | RatOS</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content="https://os.ratrig.com/img/site-banner.png?bust=1"><meta data-rh=true name=twitter:image content="https://os.ratrig.com/img/site-banner.png?bust=1"><meta data-rh=true property=og:url content=https://os.ratrig.com/docs/1.2.x/guides/4028><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=1.2.x><meta data-rh=true name=docusaurus_tag content=docs-default-1.2.x><meta data-rh=true name=docsearch:version content=1.2.x><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-1.2.x><meta data-rh=true property=og:title content="Connecting a 4028 fan | RatOS"><meta data-rh=true name=description content="4028 server fans are becoming a popular option for part cooling because of their light weight and great pressure and flow rates. In this guide we'll go over how to connect one and use it for part cooling. 4-pin fans usually aren't used in 3d printers, and many boards only provide 2-pin ports, but fear not! There's always a way."><meta data-rh=true property=og:description content="4028 server fans are becoming a popular option for part cooling because of their light weight and great pressure and flow rates. In this guide we'll go over how to connect one and use it for part cooling. 4-pin fans usually aren't used in 3d printers, and many boards only provide 2-pin ports, but fear not! There's always a way."><link data-rh=true rel=icon href=/img/favicon.png><link data-rh=true rel=canonical href=https://os.ratrig.com/docs/1.2.x/guides/4028><link data-rh=true rel=alternate href=https://os.ratrig.com/docs/1.2.x/guides/4028 hreflang=en><link data-rh=true rel=alternate href=https://os.ratrig.com/docs/1.2.x/guides/4028 hreflang=x-default><link data-rh=true rel=preconnect href=https://BH4D9OD16A-dsn.algolia.net crossorigin><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="RatOS RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="RatOS Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-NQB0MHKGLP"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NQB0MHKGLP",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title=RatOS href=/opensearch.xml><link rel=stylesheet href=/assets/css/styles.bbd8df4b.css><script src=/assets/js/runtime~main.96635bb7.js defer></script><script src=/assets/js/main.851cfeae.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"dark",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent__V8X href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/logos/Logo-white.svg alt=RatOS class="themedComponent_umBK themedComponent--light_tDpr"><img src=/img/logos/Logo-white.svg alt=RatOS class="themedComponent_umBK themedComponent--dark_RB4_"></div><b class="navbar__title text--truncate"></b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/docs/1.2.x/introduction>Documentation</a><a class="navbar__item navbar__link" href=/blog>Blog</a><a class="navbar__item navbar__link" href=/changelog>Changelog</a><a href=https://github.com/sponsors/miklschmidt target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Donate/Sponsor<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_Im5f><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><a href=https://discord.gg/ratrig target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_Im5f><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><a href=https://github.com/Rat-OS/RatOS target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_Im5f><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button href=/docs/1.2.x/guides/4028>1.2.x</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs/guides/4028>2.1.x</a><li><a class=dropdown__link href=/docs/2.0.x/guides/4028>2.0.x</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/1.2.x/guides/4028>1.2.x</a><li><a class=dropdown__link href=/changelog>Changelog</a></ul></div><div class=navbarSearchContainer_ZGM0><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_ebYn"><div class=docsWrapper_WN4a><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_U9FN" type=button></button><div class=docRoot_xhYm><aside class="theme-doc-sidebar-container docSidebarContainer_fg0s"><div class=sidebarViewport_tHZA><div class=sidebar_ICAc><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_hjoG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/docs/1.2.x/introduction>Getting Started</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/1.2.x/introduction>Introduction</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/1.2.x/installation>Installation</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/1.2.x/configuration>Initial Configuration</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/1.2.x/slicers>Slicer Configuration</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/1.2.x/troubleshooting>Troubleshooting</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/1.2.x/manual-firmware-compilation>Manual Firmware Compilation</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/changelog#updating-from-v-coreos-rc2>Updating from V-CoreOS RC2</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/1.2.x/boards/btt/octopus-11-407>Supported Boards</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/1.2.x/printers/v-core-3>Supported Printers</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/docs/1.2.x/configuration/advanced-stepper-configuration>Configuration</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/1.2.x/configuration/advanced-stepper-configuration>Advanced Stepper Configuration</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/1.2.x/configuration/includes-and-overrides>Includes & Overrides</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/1.2.x/configuration/macros>Configuring RatOS Macros</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/docs/1.2.x/guides/4028>Guides</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/1.2.x/guides/4028>Connecting a 4028 fan</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a href=https://www.klipper3d.org/ target=_blank rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true>Other Documentation</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href=https://www.klipper3d.org/ target=_blank rel="noopener noreferrer" class="menu__link menuExternalLink_GRez" tabindex=0>Klipper<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_Im5f><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href=https://docs.mainsail.xyz/ target=_blank rel="noopener noreferrer" class="menu__link menuExternalLink_GRez" tabindex=0>Mainsail<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_Im5f><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href=https://moonraker.readthedocs.io/en/latest/ target=_blank rel="noopener noreferrer" class="menu__link menuExternalLink_GRez" tabindex=0>Moonraker<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_Im5f><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href=https://klipperscreen.readthedocs.io/ target=_blank rel="noopener noreferrer" class="menu__link menuExternalLink_GRez" tabindex=0>KlipperScreen<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_Im5f><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></ul></nav></div></div></aside><main class=docMainContainer_UI_Y><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_CeS1"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role=alert><div>This is documentation for <!-- -->RatOS<!-- --> <b>1.2.x</b>, which is no longer actively maintained.</div><div class=margin-top--md>For up-to-date documentation, see the <b><a href=/docs/guides/4028>latest version</a></b> (<!-- -->2.1.x<!-- -->).</div></div><div class=docItemContainer_Zjux><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_r5Rz" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_JWO4><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Guides</span><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Connecting a 4028 fan</span><meta itemprop=position content=2></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.2.x</span><div class="tocCollapsible_ih3I theme-doc-toc-mobile tocMobile__geE"><button type=button class="clean-btn tocCollapsibleButton_NB0r">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Connecting a 4028 fan</h1></header>
<p>4028 server fans are becoming a popular option for part cooling because of their light weight and great pressure and flow rates. In this guide we'll go over how to connect one and use it for part cooling. 4-pin fans usually aren't used in 3d printers, and many boards only provide 2-pin ports, but fear not! There's always a way.</p>
<h2 class="anchor anchorWithStickyNavbar_D_I3" id=power>Power<a href=#power class=hash-link aria-label="Direct link to Power" title="Direct link to Power">​</a></h2>
<div class="theme-admonition theme-admonition-danger admonition_ZYOd alert alert--danger"><div class=admonitionHeading_H4Ba><span class=admonitionIcon_251E><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"/></svg></span>danger</div><div class=admonitionContent_CRZj><p>Please read this carefully. You will fry your fan if you don't supply the correct voltage!</div></div>
<p>The black and the red pin are for power, you need to connect these to an always on source. Since most of these are 12v, you'll need a 12v source. Boards such as the octopus or the spider come with decent 12v rails on board so you can easily power your 4028 directly from the board via an always-on selectable voltage fan port. Simply connect the red wire to the positive terminal and the black to the negative of the always-on fan port. For other boards without a 12v option, you'll have to use a 12V PSU or a dc/dc converter. If you go that route, be sure to connect the grounds of your 24V PSU and the 12V PSU or dc/dc converter (usually dc/dc converters have the ground pins bridged, so no need to connect the grounds).</p>
<h2 class="anchor anchorWithStickyNavbar_D_I3" id=pwm>PWM<a href=#pwm class=hash-link aria-label="Direct link to PWM" title="Direct link to PWM">​</a></h2>
<p>On Delta fans the blue wire is the PWM wire, on Sanyo's it's the brown wire. If you're unsure, refer to your fans datasheet. To control the 4028's the PWM wire is fed a 5V PWM signal from the board. An easy way to do this is to hook it up to the negative terminal of the part cooling fan port (refer to your boards wiring diagram). We need to invert the logic of the fan_part_cooling_pin to generate a PWM signal the fan can understand. You can do that with the following piece of configuration in your user overrides section.</p>
<div class="theme-admonition theme-admonition-info admonition_ZYOd alert alert--info"><div class=admonitionHeading_H4Ba><span class=admonitionIcon_251E><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>info</div><div class=admonitionContent_CRZj><p>On boards with fan voltage selection (such as the Octopus boards), the voltage doesn't matter. The selector only changes which source the positive pin is connected to. We don't use the positive pin, we use the negative, which is a mosfetted ground connection.</div></div>
<div class="language-properties codeBlockContainer_r8aP theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_mn9A><pre tabindex=0 class="prism-code language-properties codeBlock_UNa9 thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_gI_7><span class=token-line style=color:#F8F8F2><span class="token plain">[fan]</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">!fan_part_cooling_pin</span><br></span></code></pre><div class=buttonGroup_lwhC><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_D3_B aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_LaYT><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_eLJY><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The wiring would look like this on an Octopus board.</p>
<p><img decoding=async loading=lazy alt="Octopus 4028 Wiring" src=/assets/images/4028-octopus-e85f43eedd62ff6333b2b5c9dd406a4d.png width=874 height=452 class=img_Q1RW></p>
<p>Further more, these fans usually want a 25khz PWM signal to function properly, although some work better with 100hz. Try both and test different fans speeds to find out what works best for your particular fan:</p>
<h3 class="anchor anchorWithStickyNavbar_D_I3" id=25khz-pwm-signal>25KHZ PWM Signal<a href=#25khz-pwm-signal class=hash-link aria-label="Direct link to 25KHZ PWM Signal" title="Direct link to 25KHZ PWM Signal">​</a></h3>
<div class="language-properties codeBlockContainer_r8aP theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_mn9A><pre tabindex=0 class="prism-code language-properties codeBlock_UNa9 thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_gI_7><span class=token-line style=color:#F8F8F2><span class="token plain">[fan]</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">!fan_part_cooling_pin</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">cycle_time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">0.00004</span><br></span></code></pre><div class=buttonGroup_lwhC><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_D3_B aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_LaYT><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_eLJY><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_D_I3" id=100hz-pwm-signal>100HZ PWM Signal<a href=#100hz-pwm-signal class=hash-link aria-label="Direct link to 100HZ PWM Signal" title="Direct link to 100HZ PWM Signal">​</a></h3>
<div class="language-properties codeBlockContainer_r8aP theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_mn9A><pre tabindex=0 class="prism-code language-properties codeBlock_UNa9 thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_gI_7><span class=token-line style=color:#F8F8F2><span class="token plain">[fan]</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">!fan_part_cooling_pin</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">cycle_time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">0.01</span><br></span></code></pre><div class=buttonGroup_lwhC><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_D3_B aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_LaYT><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_eLJY><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_D_I3" id=tachometer>Tachometer<a href=#tachometer class=hash-link aria-label="Direct link to Tachometer" title="Direct link to Tachometer">​</a></h2>
<p>The fourth pin is the tachometer pin, this pin is used to read the RPM of the fan, which, if configured, will be displayed next to the fan speed in Mainsail. You can use any available GPIO on your board for this, if you want, or just leave it disconnected. The following config will enable the tachometer read out:</p>
<div class="language-properties codeBlockContainer_r8aP theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_mn9A><pre tabindex=0 class="prism-code language-properties codeBlock_UNa9 thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_gI_7><span class=token-line style=color:#F8F8F2><span class="token plain">[fan]</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">!fan_part_cooling_pin</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">cycle_time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">0.00004 # or 0.01</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">tachometer_pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">^PD14 # Made up pin name, look up your boards pinout diagram to get the pin name for the pin you've chosen</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">tachometer_poll_interval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">0.0005 # will support up to a 30.000 RPM fan with 2 pulses per rotation.</span><br></span></code></pre><div class=buttonGroup_lwhC><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_D3_B aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_LaYT><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_eLJY><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Notice the <code>^</code> in front of the pin name, this is a hardware pullup which is generally necessary to read the tachometer signal. For more information on tachometer configuration, refer to the <a href="https://www.klipper3d.org/Config_Reference.html?h=tachometer#fan" target=_blank rel="noopener noreferrer">klipper configuration reference</a></p>
<h2 class="anchor anchorWithStickyNavbar_D_I3" id=my-fan-runs-at-100-until-klipper-boots>My fan runs at 100% until klipper boots<a href=#my-fan-runs-at-100-until-klipper-boots class=hash-link aria-label="Direct link to My fan runs at 100% until klipper boots" title="Direct link to My fan runs at 100% until klipper boots">​</a></h2>
<div class="theme-admonition theme-admonition-danger admonition_ZYOd alert alert--danger"><div class=admonitionHeading_H4Ba><span class=admonitionIcon_251E><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"/></svg></span>Do not do this if you have the tachometer pin connected. It will potentially fry your board.</div><div class=admonitionContent_CRZj><p>On some fans (verified on Sanyo Denki's) disconnecting the ground pin while 12V is connected to the fan will cause a high voltage on the tachometer pin, this can fry your mcu. Do <strong>NOT</strong> connect the tachometer pin if you do this.</div></div>
<p>This is a safety feature of server fans, they will always run at 100% until they get a PWM signal. It's a bit annoying for 3d printer use, but there's a way around that. You can use the negative terminal of a spare heater port to only power the fan when the board is booted, by connecting the black wire (gnd) to the negative terminal of the heater port. Since these fans run high amperages, it's important that we use a pwm port backed by a properly rated mosfet, which is why the heater ports are perfect. Let's say we connect the gnd wire to the second heater of our board which is controlled by the pin <code>PA9</code> (made up pin name, look up the correct pin in your boards pin diagram), the configuration would be the following:</p>
<div class="language-properties codeBlockContainer_r8aP theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_mn9A><pre tabindex=0 class="prism-code language-properties codeBlock_UNa9 thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_gI_7><span class=token-line style=color:#F8F8F2><span class="token key attr-name" style="color:rgb(241, 250, 140)">[output_pin</span><span class="token plain"> </span><span class="token value attr-value">4028_POWER]</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">PA9</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">1</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">shutdown_value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">0 # turn the fan power off on MCU shutdown.</span><br></span></code></pre><div class=buttonGroup_lwhC><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_D3_B aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_LaYT><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_eLJY><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Since Sep 2, 2022 there's now an <code>enable_pin</code> in the <code>[fan]</code> section that does the same thing and on top of that it turns the fan power off if speed is 0, so now you can just do:</p>
<div class="language-properties codeBlockContainer_r8aP theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_mn9A><pre tabindex=0 class="prism-code language-properties codeBlock_UNa9 thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_gI_7><span class=token-line style=color:#F8F8F2><span class="token plain">[fan]</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">!fan_part_cooling_pin</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">cycle_time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">0.01</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">enable_pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">PA9</span><br></span></code></pre><div class=buttonGroup_lwhC><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_D3_B aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_LaYT><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_eLJY><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>That's it! Enjoy using your 4028 for excellent part cooling :)</p>
<h2 class="anchor anchorWithStickyNavbar_D_I3" id=my-fan-doesnt-shut-off-at-0>My fan doesn't shut off at 0%<a href=#my-fan-doesnt-shut-off-at-0 class=hash-link aria-label="Direct link to My fan doesn't shut off at 0%" title="Direct link to My fan doesn't shut off at 0%">​</a></h2>
<p>See the instructions for wiring above and use the <code>enable_pin</code> like so:</p>
<div class="language-properties codeBlockContainer_r8aP theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_mn9A><pre tabindex=0 class="prism-code language-properties codeBlock_UNa9 thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_gI_7><span class=token-line style=color:#F8F8F2><span class="token plain">[fan]</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">!fan_part_cooling_pin</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">cycle_time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">0.01</span><span class="token plain"></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key attr-name" style="color:rgb(241, 250, 140)">enable_pin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token value attr-value">PA9</span><br></span></code></pre><div class=buttonGroup_lwhC><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_D3_B aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_LaYT><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_eLJY><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>That will turn off the fan at 0%.</p>
<h2 class="anchor anchorWithStickyNavbar_D_I3" id=bonus-what-to-look-for-in-a-4028-fan>Bonus: What to look for in a 4028 fan?<a href=#bonus-what-to-look-for-in-a-4028-fan class=hash-link aria-label="Direct link to Bonus: What to look for in a 4028 fan?" title="Direct link to Bonus: What to look for in a 4028 fan?">​</a></h2>
<p>Airflow (common units: cfm, m3/h) isn't everything, we want as much pressure we can get to effectively push the high airflow through our ducts, a good fan is balanced between airflow and pressure. Air pressure is usually expressed in inches of water (in. h2o) or pascals, there are online tools to convert between different units, so you can compare the fans before buying, just google "inches of water to pascal" or whatever units you need to convert.</p>
<p>A good performing 4028 fan will have around 25-30 CFM and over 3 inches of water. For example the <code>Delta FFB0412UHN-SM36</code> or the <code>Sanyo 9GAX0412P3S001</code>. Take a look at the datasheet for the fan and make sure it runs at low PWM levels, you don't always want high output and it's important that the fan you choose supports low speeds as well as high speeds. Generally you want around a maximumum RPM of 20.000-25.000 to keep the rotor light, extremely fast fans such as the twice as powerful <code>Delta PFB0412EN-E</code> needs a heavier rotor and is therefore slower to change speeds. Generally the <code>Sanyo 9GAX0412P3S001</code> is regarded as the most well rounded 4028 fan currently, but they can be hard to get, so take a look around and see what you can find, there are many options out there.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/Rat-OS/RatOS/edit/v2.x/site/versioned_docs/version-1.2.x/guides/4028.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Lzxc aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_Vlfz"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/1.2.x/configuration/macros><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Configuring RatOS Macros</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_npFu thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#power class="table-of-contents__link toc-highlight">Power</a><li><a href=#pwm class="table-of-contents__link toc-highlight">PWM</a><ul><li><a href=#25khz-pwm-signal class="table-of-contents__link toc-highlight">25KHZ PWM Signal</a><li><a href=#100hz-pwm-signal class="table-of-contents__link toc-highlight">100HZ PWM Signal</a></ul><li><a href=#tachometer class="table-of-contents__link toc-highlight">Tachometer</a><li><a href=#my-fan-runs-at-100-until-klipper-boots class="table-of-contents__link toc-highlight">My fan runs at 100% until klipper boots</a><li><a href=#my-fan-doesnt-shut-off-at-0 class="table-of-contents__link toc-highlight">My fan doesn't shut off at 0%</a><li><a href=#bonus-what-to-look-for-in-a-4028-fan class="table-of-contents__link toc-highlight">Bonus: What to look for in a 4028 fan?</a></ul></div></div></div></div></main></div></div></div></div>